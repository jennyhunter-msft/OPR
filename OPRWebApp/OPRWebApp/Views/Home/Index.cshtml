@{
    ViewBag.Title = "OPR";
}

<div class="jumbotron">
    <h1>Optimal Pickup Routes (OPR)</h1>
    <p class="lead"> OPR allows you to work with others to follow a shortest distance path. </p>
    <p>
        Do you need to pick up friends from all across the area? With OPR, you can put their addresses into our system as stops, and it will give you the optimal path to pick them up. In addition, they can track your location using the “Locate Traveler” feature.
    </p>

    @Html.TextBox("Location")
    <input type="button" value="Add to Path" onclick="AddLocationToRoute()" />
    <p id="CurrentPath">
    <p id="LocationCoordinates" />

</div>

<script language="JavaScript" type="text/javascript" src="../../../Scripts/jquery-3.1.1.js"></script>

<script>
    document.getElementById("Location").addEventListener("keydown", function (e) {
        //When Enter is pressed
        if (e.keyCode == 13) {
            AddLocationToRoute();
        }
    }, false);

    function AddLocationToRoute() {
        $.ajax({
            url: '@Url.Action("AddLocationToPath", "Home")',
            type: 'POST',
            async: false,
            dataType: 'json',
            data: {
                sessionId: "@ViewBag.SessionId",
                pathId: "@ViewBag.PathId",
                location: $('#Location').val()
            },
            success: function (result) {
                document.getElementById("CurrentPath").innerHTML = result.join("<br />");
            },
            error: function (result) {
                alert($.parseJSON(result.responseText).error);
            }
        });
    }

    $(document).ready(function() {
        document.getElementById("CurrentPath").innerHTML = "@Html.Raw(ViewBag.CurrentPath)";
    });
</script>
